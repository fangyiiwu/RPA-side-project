# RPA-side-project
個人RPA(Robotic process automation)實作練習，有Uipath和Excel VBA兩項目，以下詳細介紹流程和RPA機器人內容。

|**流程名稱**|**使用工具**|**處理問題**|
|----|---|---|
|網路新聞擷取| Uipath| **瀏覽器**、**檔案總管**、**Excel檔案**操作|
|國軍人員列管造冊小工具| VBA | **Excel巨集**操作|

## 一、網路新聞擷取
### 概述
- 人工流程說明：
	- **內容(what)**: 在聯合新聞網搜尋關鍵字，將搜尋結果新聞的標題和內容儲存於記事本
	- **目的(why)**:
		- 蒐集特定關鍵字的網路新聞，供使用者快速瞭解內容、也能做後續其他用途
	- **事項(how)**:
		1. 人工根據關鍵字，在新聞網搜尋新聞
		2. 儲存新聞標題和內文
		3. 按照關鍵字將各篇新聞整理好

- 機器人執行畫面：
	- 請參考此[影片連結](https://youtu.be/xr5YkG8WsXA?si=ui7uq-7pjzOI9jsB "影片連結")。內有執行過程錄影與文字解說，方便理解流程如何進行。

### 檔案
| |**Input**|**Output**|
|----|---|---|
|**檔名**|[搜尋關鍵字.xlsx](新聞擷取器/搜尋關鍵字.xlsx)|新聞標題.txt|
|**內容**|要在聯合新聞網搜尋的「關鍵字、篇數」|機器人抓取結果，檔名=日期+新聞標題；內容=新聞內文|

### 功能細節
1. **讀取內容**
	- 1.1: 開啟**搜尋關鍵字.xlsx**，讀取欲搜尋的關鍵字和預計儲存篇數

2. **查詢新聞**: 
	- 2.1: 根據關鍵字建立資料夾
	- 2.2: 開啟聯合新聞網，搜尋關鍵字
	- 2.3: 每個關鍵字搜尋結果根據要查詢篇數，逐篇點入新聞、將內文存於記事本。儲存完畢跳回前一頁。
	- 2.4: 一關鍵字儲存達預期篇數，即進入下個關鍵字。
	- 2.5: 當所有關鍵字搜尋完畢，流程結束

### 開發環境
* UiPath.System.Activities
* UiPath.UIAutomation.Activities
* UiPath.Excel.Activities


### 維運資訊
* 若關鍵字或欲搜集篇數更動，直接編輯** 搜尋關鍵字.xlsx**內容即可。
* 若需新增關鍵字，使用者在Excel檔下方新增一列即可

### 故障排除和維護

| **異常狀況**|**可能原因**|**解決方式**|
|----|---|---|
|無法正常抓取新聞內容| 網站改版或HTML 屬性變動|修正程式碼以符合網頁內容，可先由studio內建UI explorer確認欲抓取項目屬性|
|無法讀取Excel檔案|檔案位置有移動|確認Excel檔案位置是否在main.xaml同一層資料夾|
|Excel檔案位置正確，卻沒讀取到關鍵字、篇數|欲讀取內容不在正確位置|確認關鍵字在工作表“sheet1” A欄、篇數在B欄|

---
## 二、國軍人員列管造冊小工具
### 概述
- **內容（what)**：
	- 透過excel公式結合VBA，將google表單回覆，自動產生符合國軍格式的新兵列管項目表格。
- **目的(why)**：
	- Why有這個檔案：
		- **檔案用途**：國軍為掌握新進人員，避免人員服役期間在營區或營外發生事故或違反軍紀事件，因此將特定習性人員列管造冊
		- **緣起**：這是當兵期間與連上輔導長構思如何優化新兵資料建立流程而生。
		- **痛點**：由人工完成要求格式，需大量複製貼上和換行，依照特定邏輯，手動逐筆修改成特定詞彙，耗時耗力難以批量處理
	- Why這樣設計：
		- 為顧及使用者**易維護性**和**可擴充性**，使用excel公式結合VBA、而非全VBA。
		- 將商業邏輯設計在excel公式讓使用者能自行修改；VBA則處理重複性動作。
- **事項(how)**:
	- 概念: 根據新進人員填寫之google表單，針對特定問題回答，製作國防部所需對應列管項目
	- 實作:
		- step 1: google表單原始回答
		- step 2: 透過欄位公式，將原始回答轉換成對應詞彙
		- step 3: VBA將個人所有列管項目整合成國軍所需格式

### 功能細節
1. **原始資料導入**：
	- 1.1: 手動貼入Google表單搜集之回覆
2. **產生所需格式資料**: 
	- 2.1: 資料導入後，配合工作表“列管temp”已建立之公式，將回答轉成需要的詞彙。
	- 2.2: 巨集按鈕1=將公式製作的詞彙，統合在同一儲存格，並且計算有多少項目，形成該員的列管項目。
	- 2.3: 巨集按鈕2=篩選出有列管項目的人員，將內容複製到工作表“列管final”
3. **匯出內容和重複執行**: 
	- 3.1: 手動將工作表“列管final”複製至word，即為國軍要求之格式內容
	- 3.2: 巨集按鈕清除=將前兩個巨集在工作表“列管temp”和“列管final”產生的內容清除，使此excel檔能重複利用。

### 維運資訊

* 若Google表單題目順序移動或增減，影響公式欄位判斷，修改工作表“列管temp”中公式參照欄位即可
* 若列管項目詞彙有異動，更改工作表“列管temp”中公式內容即可
